
/* Smart UI v7.0.0 (2020-Mar)
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("Grid.Edit",class{_renderCommandBar(){const e=this,t=e.editing.commandBar.dataSource,i=i=>{for(let d in t){const n=t[d],l=document.createElement("div");l.classList.add("smart-grid-command-item"),l.label=e.localize(d),n.icon&&(l.innerHTML="<span class=\"smart-grid-icon "+n.icon+"\"></span><span class=\"smart-grid-label\">"+l.label+"</span>"),n.visible||l.classList.add("smart-hidden"),l.command=n.command,l.onclick=function(){const t=l.command;e._applyCommand(t,[])},i.appendChild(l)}};e.editing.enabled&&e.editing.commandBar.visible&&(e.$.headerCommandBar.innerHTML="",e.$.footerCommandBar.innerHTML="","far"!==e.editing.commandBar.position&&i(e.$.headerCommandBar),"near"!==e.editing.commandBar.position&&i(e.$.footerCommandBar))}commandKeyEditCommand(){const e=this;if(e._selection&&e._selection.focusedCell&&e._selection.focusedCell.row){const t=e._selection.focusedCell.row;e.beginEdit(t.id)}}commandKeyCancelCommand(){const e=this;e.cancelEdit()}commandKeyUpdateCommand(){const e=this;e.endEdit()}commandColumnMenuCommand(){const e=this;e._openColumnChooserMenu(e._commandColumn)}commandColumnEditCommand(e){const t=this;t.beginEdit(e.id)}commandColumnUpdateCommand(){const e=this;e.endEdit()}commandColumnRowMenuCommand(){}commandColumnCancelCommand(e){const t=this;if(t.editing.batch){const i=t._rowsDeleted?t._rowsDeleted.indexOf(e):-1;0<=i&&t._rowsDeleted.splice(i,1);for(let d=0;d<t.columns.length;d++){const i=t.columns[d].dataField;t._cellsUpdatedValues&&t._cellsUpdatedValues[e.id+"_"+i]&&(delete t._cellsUpdatedValues[e.id+"_"+i],t._cellsUpdatedValues.length--)}t._recycle(!1)}t.cancelEdit()}commandColumnDeleteCommand(e){const t=this;t.deleteRow(e.id)}_renderAddNewRow(){const e=this;e._frozenNearDefaultRows=[],e._frozenFarDefaultRows=[];const t=new Smart.Grid.Row({data:{},index:-1,grid:e,freeze:"near",visible:"far"!==e.editing.addNewRow.position,autoGenerated:!0,addNewRow:!0}),i=new Smart.Grid.Row({data:{},index:-2,grid:e,freeze:"far",visible:"near"!==e.editing.addNewRow.position,autoGenerated:!0,addNewRow:!0});if(e._newNearRow){const t=e._frozenNearRows.indexOf(e._newNearRow);if(0<=t&&(e._frozenNearRows.splice(t,1),0<e.$.rowNearContainer.children.length)){const t=e.$.rowNearContainer.children[0];t.parentNode.removeChild(t)}}if(e._newFarRow){const t=e._frozenFarRows.indexOf(e._newFarRow);if(0<=t&&(e._frozenFarRows.splice(t,1),0<e.$.rowFarContainer.children.length)){const t=e.$.rowFarContainer.children[e.$.rowFarContainer.children.length-1];t.parentNode.removeChild(t)}}if(e.editing.addNewRow.visible&&(e._frozenNearDefaultRows.push(t),e._frozenFarDefaultRows.push(i),e._frozenNearRows.splice(0,0,t),e._frozenFarRows.push(i)),e._scrollView.vScrollBar.$.farButton.addEventListener("click",function(){e.editing.addNewRow.autoCreate&&e._scrollView.vScrollBar.value===e._scrollView.vScrollBar.max&&(e.addUnboundRow(1),e._scrollView.vScrollBar.value=e._scrollView.vScrollBar.max)}),e._newNearRow=t,e._newFarRow=i,e.editing.addNewRow.visible){if(!e._newNearRow.element){const t=e._newNearRow,i=t.createElement();t.visible="far"!==e.editing.addNewRow.position,t.element=i,0<e.$.rowNearContainer.children.length?e.$.rowNearContainer.insertBefore(i,e.$.rowNearContainer.children[0]):e.$.rowNearContainer.appendChild(i)}if(!e._newFarRow.element){const t=e._newFarRow,i=t.createElement();t.visible="near"!==e.editing.addNewRow.position,t.element=i,0<e.$.rowFarContainer.children.length?e.$.rowFarContainer.insertBefore(i,e.$.rowFarContainer.children[0]):e.$.rowFarContainer.appendChild(i)}}}_insertNewRowAfter(e){const t=this;return t._insertNewRowBefore(e,!0)}_insertNewRowBefore(e,t){const i=this,d=new Smart.Grid.Row({index:t?0:-1,id:Smart.Utilities.Core.createGUID(),grid:i}),n=function(t,d){!0===i.editing.batch||i.editing.batch&&0<=i.editing.batch.indexOf("add")?i._batchAddRow(t,d?i.rows.length:0):(t.index=i.rows.length,i._add(t,d?i.rows.length:0)),i.scrollTop=d?i.scrollHeight:0,i.editing.addDialog.enabled||setTimeout(function(){i.editing.enabled&&i._beginEdit(t)},100),e&&e(t)}.bind(this);return i.editing.addDialog.enabled?i._openAddRowDialog(d,n):n(d,t),!0}commandBarBatchSaveCommand(){const e=this;e._saveBatchEdit()}commandBarAddRowCommand(){const e=this;e._insertNewRowAfter()}commandBarAddTopRowCommand(){const e=this;e._insertNewRowBefore()}commandBarDeleteRowCommand(){const e=this;let t=1,i=e.rows[e.rows.length-t];for(e._rowsDeleted||(e._rowsDeleted=[]);0<=e._rowsDeleted.indexOf(e.rows[e.rows.length-t]);)t++;i=e.rows[e.rows.length-t],i&&e.commandColumnDeleteCommand(i)}commandBarBatchRevertCommand(){const e=this;e.revertBatchEdit()}_beginEdit(e,t){const i=this;t||(t=i.columns[0].dataField);const d=i.columnByDataField[t];if(i.editing.allowColumnHeaderEdit&&!e&&d)return void i._beginColumnEdit(d);if(!e||!d||d&&d.autoGenerated)return!1;const n=e.getCell(t);return!!n&&void("cell"===i.editing.mode?i._beginCellEdit(n):"row"===i.editing.mode&&i._beginRowEdit(e,n),i.$.fireEvent("beginEdit",{row:e,column:d,cell:n}))}_saveUnboundRows(e){const t=this;if(t._unboundRows&&0<t._unboundRows.length&&t.editing.addNewRow.autoSave){const i=t.rowById[e];if(!i.unbound)return;const d=t._unboundRows.indexOf(i);if(0>d)return;const n=d+1;t.beginUpdate();for(let e=0;e<n;e++){const i=t._unboundRows[e];if(!i)continue;delete t.rowById[i.id],i.unbound=!1;let d=!1;t._selection.focusedCell&&t._selection.focusedCell.row.id===i.id&&(d=!0),t._nearRowsAdded&&0<=t._nearRowsAdded.indexOf(i)?(t._nearRowsAdded.splice(t._nearRowsAdded.indexOf(i),1),t._add(0,i.data),d&&(t._selection.focusedCell.row=t.rows[0])):t._farRowsAdded&&0<=t._farRowsAdded.indexOf(i)&&(t._farRowsAdded.splice(t._farRowsAdded.indexOf(i),1),t._add(i.data),d&&(t._selection.focusedCell.row=t.rows[t.rows.length-1]))}t._unboundRows.splice(0,n),t.endUpdate()}}_endCellEdit(e){const t=this,i=e||t.editing.editCell;if(!i||i&&!i.isEditing)return null;const d=t._getEditorValue(i);if("invalid value"===d)return i.setAttribute("error",""),!1;const n=function(){const e=t._getEditorId(i),n=t._cellEditors[e];n.detach(),i.row.element.removeAttribute("edit"),i.element.removeAttribute("editor"),i.element.removeAttribute("error"),i.isEditing=!1,i.element.content.innerHTML="";const l=function(){t.editing.editRow||t._recycle(!1)},o=t._cellsUpdatedValues?t._cellsUpdatedValues[i.row.id+"_"+i.column.dataField]:void 0,a=void 0===o?i.value:o;if(!function(e,t){return"date"===i.column.dataType?e.valueOf()===t.valueOf():e===t}(d,a)){const e=function(){t.editing.editCell=null,t.editing.editRow||(t.editing.isEditing=!1)};if(!0===t.editing.batch||t.editing.batch&&0<=t.editing.batch.indexOf("update"))e(),t._batchUpdateCell(i.row,i.column,d,i.value),l();else{(function(){e(),i._updating=!0,i.value=d,i._updating=!1,l()})()}}else t.editing.editCell=null,t.editing.editRow||(t.editing.isEditing=!1,l());return t.editing.commandColumn.visible&&!t.editing.commandColumn.width&&"cell"===t.editing.mode&&t.refresh(),t.focus(),!0};if(t.onCellUpdate){t.beginUpdate(),t.appearance.displayLoadingIndicator=!0,t._setLoadingIndicatorVisibility();const e=t._createOverlay();t.$.root.appendChild(e),t.onCellUpdate(i,t.oldValue,d,function(i){i?n():t.cancelEdit(),t.appearance.displayLoadingIndicator=!1,t._setLoadingIndicatorVisibility(),e.parentNode.removeChild(e),t.endUpdate()})}else n()}_endRowEdit(){const e=this,t=e.editing.editRow;if(!t)return!1;let d=!0;const n=t.cells;let l={},o={};for(let t=0;t<n.length;t++){const i=n[t],a=e._getEditorValue(i);l[i.column.dataField]=i.value,o[i.column.dataField]=a,"invalid value"===a&&(i.setAttribute("error",""),d=!1)}if(d){const i=function(){for(let t=0;t<n.length;t++){const i=n[t];e._endCellEdit(i)}e.editing.isEditing=!1,e.editing.editRow=null,e.editing.commandColumn.visible&&!e.editing.commandColumn.width?e.refresh():e._recycle(!1)};if(e.onRowUpdate){e.beginUpdate(),e.appearance.displayLoadingIndicator=!0,e._setLoadingIndicatorVisibility();const d=e._createOverlay();e.$.root.appendChild(d),e.onRowUpdate(t,l,o,function(t){t?i():e.cancelEdit(),e.appearance.displayLoadingIndicator=!1,e._setLoadingIndicatorVisibility(),d.parentNode.removeChild(d),e.endUpdate()})}else i();return!0}return e.focus(),!1}_batchDeleteRow(e){const t=this;t._rowsDeleted||(t._rowsDeleted=[]),t._rowsDeleted.push(e),t._recycle(!1)}_batchAddRow(e,t){const i=this;i._rowsAdded||(i._rowsAdded=[]),i._rowsAdded.push(e.id),i.rowById[e.id]=e,e.index=i.rows.length+(i._rowsAdded?i._rowsAdded.length:0),0===t?i._nearRowsAdded.splice(0,0,e):i._farRowsAdded.push(e);const d=i.isInitialized&&i._rowElements&&i._rowElements.length<i.rows.length+i._rowsAdded.length;d&&i._initializeRowElements(),i.refresh()}_batchUpdateCell(e,t,i,d){const n=this;n._cellsUpdatedValues||(n._cellsUpdatedValues=[]);(function(e,i){return"date"===t.dataType?e.valueOf()===i.valueOf():e===i})(i,d)?delete n._cellsUpdatedValues[e.id+"_"+t.dataField]:n._cellsUpdatedValues[e.id+"_"+t.dataField]=i,n._cellsUpdatedValues.length++}_saveBatchEdit(){const e=this;for(let t in e._cellsUpdatedValues){const i=e._cellsUpdatedValues[t],d=t.substring(0,t.indexOf("_")),n=t.substring(t.indexOf("_")+1),l=e.rowById[d],o=l.getCell(n);o._updating=!0,o.value=i,o._updating=!1}const t=e._rowsDeleted&&0<e._rowsDeleted.length||e._rowsAdded&&0<e._rowsAdded.length;if(t&&e.beginUpdate(),e._rowsAdded&&0<e._rowsAdded.length)for(let t in e._rowsAdded){const i=e._rowsAdded[t],d=e.rowById[i];d&&(0<=e._nearRowsAdded.indexOf(d)?e.rows.splice(0,0,d):0<=e._farRowsAdded.indexOf(d)&&e.rows.push(d))}if(e._rowsDeleted&&0<e._rowsDeleted.length)for(let t=0;t<e._rowsDeleted.length;t++){const i=e._rowsDeleted[t],d=e.rows.indexOf(i);0>d||e.rows.splice(d,1)}t&&e.endUpdate(),e._clearBatchEdit(!1)}_clearBatchEdit(){const e=this;let t=!1;e._rowsAdded&&0<e._rowsAdded.length&&(t=!0),e._cellsUpdatedValues=[],e._rowsAdded=[],e._rowsDeleted=[],e._nearRowsAdded=[],e._farRowsAdded=[],t?e.refresh():e._recycle(!1)}_getEditorId(e){return e.editor===e.column.editor?e.editor.template+"_"+e.column.dataField:e.editor.template+"_"+e.column.dataField+"_"+e.row.id}_applyCommand(e,t){const i=this;t||(t=[]);const d=function(){"function"==typeof e?e.apply(i,t):i[e]?i[e].apply(i,t):Smart[e]?Smart[e].apply(i,t):window[e]&&window[e].apply(i,t)};if(i.onCommand){t||(t=[]),t[1]||(t[1]=null);const n={name:e,command:d,details:t[0],event:t[1],handled:!1};setTimeout(()=>{i.onCommand.apply(i,[n]);n.handled||d()},200)}else d()}_getCommandColumnCommandsTemplate(){const e=this,t=e.editing.commandColumn.dataSource,i="icon"!==e.editing.commandColumn.displayMode,d="label"!==e.editing.commandColumn.displayMode;let n="";for(let l in t){const o=t[l];let a="<div",r=!1;if("commandColumnMenu"==l)continue;r||(a+=" item=\""+l+"\" command=\""+o.command+"\" class=\"smart-grid-command-item\">",r=!0);const s="{{messages}}"===o.label?e.localize(l):o.label;d&&i?(a+="<span class=\"smart-grid-icon "+o.icon+"\"></span>",a+="<span class=\"smart-grid-label\">"+s+"</span>"):d&&!i?a+="<span class=\"smart-grid-icon "+o.icon+"\"></span>":i&&!d&&(a+="<span class=\"smart-grid-label\">"+s+"</span>"),a+="</div>",n+=a}return n}_updateCommandColumnCommandsVisibility(e,t){const d=this,n=e.children,l=d.editing.commandColumn.dataSource;for(let o=0;o<n.length;o++){const e=n[o],i=e.getAttribute("item"),a=l[i].visible;!0===a?e.classList.remove("smart-hidden"):!1===a?e.classList.add("smart-hidden"):"auto"===a&&(!d.editing.dialog.enabled&&(d.editing.editRow===t||d.editing.editCell&&d.editing.editCell.row===t)?"commandColumnEdit"===i?e.classList.add("smart-hidden"):("commandColumnUpdate"===i||"commandColumnCancel"===i)&&n[o].classList.remove("smart-hidden"):"commandColumnEdit"===i?e.classList.remove("smart-hidden"):("commandColumnUpdate"===i||"commandColumnCancel"===i)&&n[o].classList.add("smart-hidden"))}}_handleEditKeyDown(e){const t=this,i=e.key,d=t.editing.commandKeys;if(!t.editing.dialog.enabled)for(let e in d){const n=d[e],l=n.key.replace(/ /ig,"").split("|");if(!("Tab"===i&&t.editing.editRow)&&0<=l.indexOf(i)){t._applyCommand(n.command);break}}}_getCustomCellEditor(e){const t=this;e.editor.selector=e.editor.template,e.editor.template="custom";const i=t._getEditorId(e);if(!t._cellEditors[i]){const d=document.createElement("div");t._applyCellEditorUserSettings(d,e),d.classList.add("smart-grid-cell-editor");const n=function(e){if("keydown"===e.type)return void t._handleEditKeyDown(e)};let l=null;if((e.editor.selector.startsWith("#")||e.editor.selector.startsWith("."))&&(l=document.querySelector(e.editor.selector)),l)d.appendChild(l.content.cloneNode(!0).firstElementChild);else{const t=function(e){const t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild},i=t(e.editor.selector);i&&d.appendChild(i)}t._cellEditors[i]={element:d,focus:function(){const t=e.editor.instance.element.firstElementChild;e.editor.focus?setTimeout(function(){e.editor.focus.apply(e.editor.instance.element,[])},50):setTimeout(function(){t.focus()},50)},blur:function(t){const i=e.editor.instance.element.firstElementChild;e.editor.blur?e.editor.blur.apply(e.editor.instance.element,[t]):i.blur()},getValue:function(){const t=e.editor.instance.element.firstElementChild;if(e.editor.getValue)return e.editor.getValue.apply(e.editor.instance.element,[]);const i=t.value;return i||""},setValue:function(t){const i=e.editor.instance.element.firstElementChild;if(e.editor.setValue)e.editor.setValue.apply(e.editor.instance.element,[t]);else{if(0<=i.innerHTML.indexOf("{{")){const d=i.innerHTML.replace(/{{value}}/ig,t).replace(/{{id}}/ig,e.row.id);i.innerHTML=d}i.value=t,t instanceof Date&&(i.value=t.toISOString().split("T")[0]),e.editor.instance.element.value=i.value}},attach:function(){d.addEventListener("keydown",n),e.editor.attach&&e.editor.attach.apply(d,[])},detach:function(){d.removeEventListener("keydown",n),e.editor.detach&&e.editor.detach.apply(d,[])}}}return t._cellEditors[i]}_getTextAreaCellEditor(e){const t=this,i=t._getEditorId(e),d=document.createElement("div"),n=document.createElement("textarea"),l=document.createElement("div");t._applyCellEditorUserSettings(d,e),n.style.direction="",t.rightToLeft&&(n.style.direction="rtl"),n.classList.add("smart-input"),d.classList.add("smart-grid-cell-editor"),d.classList.add("smart-grid-text-area-cell-editor"),l.classList.add("nav"),l.classList.add("smart-icon-resize-full","smart-grid-icon");const o=function(e){let i=e.key;if("keydown"===e.type)return t._handleEditKeyDown(e),void(e.shiftKey&&" "===i&&(l.click(),e.preventDefault()))};l.onclick=function(){const i=document.createElement("div"),d=document.createElement("span"),o=document.createElement("textarea"),a=e.editor.instance.element,r=document.createElement("div"),s=document.createElement("smart-scroll-bar");s.orientation="vertical",i.setAttribute("theme",t.theme),r.appendChild(o),r.classList.add("smart-grid-text-area-container"),r.appendChild(s),o.value=n.value,o.classList.add("smart-input"),l.textAreaEditorDialog=i,l.popupTextArea=o,d.classList.add("close-button"),d.classList.add("smart-grid-icon"),d.classList.add("smart-icon-cancel-circled");const c=function(){s.value=o.scrollTop,s.max=o.scrollHeight-o.offsetHeight,s.onChange=null,o.offsetHeight>=o.scrollHeight?s.classList.add("smart-hidden"):s.classList.remove("smart-hidden"),s.onChange=function(){o.scrollTop=s.value}};o.onscroll=function(){c()},o.onkeydown=function(e){"Escape"===e.key&&i.parentNode.removeChild(i),"Enter"===e.key&&e.shiftKey&&d.click()},d.onclick=function(){l.textAreaEditorDialog.parentNode.removeChild(l.textAreaEditorDialog),setTimeout(function(){n.value=o.value,n.select()},50)},i.classList.add("smart-grid-text-area-dialog"),i.appendChild(r),i.appendChild(d),document.body.appendChild(i),setTimeout(function(){o.select(),c()},50),c(),i.style.top=t._offsetTop(a)+"px",i.style.left=t._offsetLeft(a)+"px",i.style.width=a.offsetWidth+"px"},d.appendChild(n),d.appendChild(l);return t._cellEditors[i]={element:d,focus:function(){setTimeout(function(){n.select()},50)},blur:function(){},setValue:function(e){n.value=e},getValue:function(){const e=n.value;return l.textAreaEditorDialog&&l.textAreaEditorDialog.parentNode?(n.value=l.popupTextArea.value,n.value):e},attach:function(){n.addEventListener("keydown",o)},detach:function(){n.removeEventListener("keydown",o),l.textAreaEditorDialog&&l.textAreaEditorDialog.parentNode&&(n.value=l.popupTextArea.value,l.textAreaEditorDialog.parentNode.removeChild(l.textAreaEditorDialog))}},t._cellEditors[i]}_getInputCellEditor(e){const t=this,i=t._getEditorId(e);if(!t._cellEditors[i]){const d=document.createElement("input");t._applyCellEditorUserSettings(d,e),d.classList.add("smart-input"),d.classList.add("smart-grid-cell-editor"),d.classList.add("smart-grid-input-cell-editor"),d.style.direction="",t.rightToLeft&&(d.style.direction="rtl");const n=function(i){if("keydown"===i.type)return"number"!==e.column.dataType&&"int"!==e.column.dataType&&"float"!==e.column.dataType||t.editing.editColumn||i.key.match(/[0-9]/)||"-"===i.key||1!==i.key.length?void t._handleEditKeyDown(i):(i.preventDefault(),void i.stopPropagation())};t._cellEditors[i]={element:d,focus:function(){setTimeout(function(){d.select()},50)},blur:function(){},getValue:function(){return d.value},setValue:function(t){if(e.column.rowHeaderColumn&&!t)return void(d.value=e.editor.row.visibleIndex+1);if("number"===e.column.dataType||"int"===e.column.dataType||"float"===e.column.dataType){if(""===t)return;if(t&&!t.toString().match(/[0-9]/)&&"-"!==t)return}d.value=t},attach:function(){d.addEventListener("keydown",n)},detach:function(){d.removeEventListener("keydown",n)}}}return t._cellEditors[i]}_applyCellEditorUserSettings(e,t){for(let i in t.editor)if("template"!=i){if("list"==i){e.setAttribute(i,t.editor[i]);continue}e[i]=t.editor[i]}}_getAutoCompleteCellEditor(e){const t=this,i=t._getEditorId(e);if(!t._cellEditors[i]){const d=document.createElement("smart-input");t._applyCellEditorUserSettings(d,e),d.readonly&&(d.dropDownButtonPosition="right");const n=function(e){return d.opened?void 0:"keydown"===e.type?void t._handleEditKeyDown(e):void 0};d.rightToLeft=t.rightToLeft,d.classList.add("smart-grid-cell-editor"),d.classList.add("smart-grid-auto-complete-cell-editor");t._cellEditors[i]={element:d,focus:function(){setTimeout(()=>{d&&d.select&&d.select()},50)},blur:function(){},setValue:function(e){d.value=e},getValue:function(){return d.value},attach:function(){d.addEventListener("keydown",n)},detach:function(){d&&d.close&&(d.value="",d.close(),d.removeEventListener("keydown",n))}}}const d=t.getVisibleRows(),n=[];for(let l,o=0;o<d.length;o++)l=t.dataSource[d[o].index],l&&(l=l[e.column.dataField],-1===n.indexOf(l)&&n.push(l));return t._cellEditors[i].element.dataSource=n,t._cellEditors[i]}_getDateTimePickerCellEditor(e){const t=this,i=t._getEditorId(e);if(!t._cellEditors[i]){const d=document.createElement("smart-date-time-picker");d.calendarButton=!0,d.dropDownAppendTo="body",d.autoClose=!0,d.dropDownDisplayMode="calendar",d.rightToLeft=t.rightToLeft,t._applyCellEditorUserSettings(d,e);const n=function(e){return d.opened?void 0:"keydown"===e.type?void t._handleEditKeyDown(e):void 0};d.classList.add("smart-grid-cell-editor"),d.classList.add("smart-grid-date-time-picker-cell-editor");t._cellEditors[i]={element:d,focus:function(){setTimeout(()=>{d.select()},50)},blur:function(e){const i=d.getAttribute("aria-controls");if(i&&d.opened){const d=t.getBoundingRect(document.getElementById(i));e.pageX<d.left||e.pageX>d.right||e.pageY<d.top||e.pageY>d.bottom||e.preventDefault()}},setValue:function(e){d.value=e},getValue:function(){return d.value},attach:function(){d.addEventListener("keydown",n)},detach:function(){d.value="",d.close(),d.removeEventListener("keydown",n)}}}return t._cellEditors[i]}_getNumberInputCellEditor(e){const t=this,i=t._getEditorId(e);if(!t._cellEditors[i]){const d=document.createElement("div"),n=document.createElement("input"),l=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div");t._applyCellEditorUserSettings(d,e),o.tabIndex=a.tabIndex=-1,n.classList.add("smart-input"),d.classList.add("smart-grid-cell-editor"),d.classList.add("smart-grid-number-input-cell-editor"),l.classList.add("nav"),o.classList.add("up"),a.classList.add("down");const r=function(e){if("keydown"===e.type)return void t._handleEditKeyDown(e)};n.type="number",l.appendChild(o),l.appendChild(a),d.appendChild(n),d.appendChild(l);t._cellEditors[i]={element:d,focus:function(){setTimeout(function(){n.select()},50)},blur:function(){},setValue:function(e){n.value=e},getValue:function(){const e=parseFloat(n.value);return isNaN(e)||e===1/0||e===-Infinity?0:e},attach:function(){n.addEventListener("keydown",r),o.onkeydown=r,a.onkeydown=r,o.onclick=function(){const e=parseFloat(n.value);isNaN(e)||(e<n.max||""===n.max)&&(n.value=e+1)},a.onclick=function(){const e=parseFloat(n.value);isNaN(e)||(e>n.min||""===n.min)&&(n.value=e-1)}},detach:function(){n.removeEventListener("keydown",r),o.onclick=a.onclick=null,o.onkeydown=a.onkeydown=null}}}return t._cellEditors[i]}_getCheckBoxCellEditor(e){const t=this,i=t._getEditorId(e);if(!t._cellEditors[i]){const e=document.createElement("div");e.classList.add("smart-input"),e.classList.add("smart-grid-cell-editor"),e.classList.add("smart-grid-check-box-cell-editor"),e.tabIndex=0;const d=function(){!0!==e.value&&!1!==e.value&&null!==e.value&&(e.value=!1),e.value=null!==e.value&&!e.value,!1===e.value?e.removeAttribute("checked"):e.setAttribute("checked",e.value?"":"indeterminate")},n=function(e){return" "===e.key?void d():void t._handleEditKeyDown(e)};t._cellEditors[i]={getValue:function(){return e.value},setValue:function(t){e.value=t,!1===e.value?e.removeAttribute("checked"):e.setAttribute("checked",e.value?"":"indeterminate")},focus:function(){e.focus(),setTimeout(function(){e.focus()},25)},blur:function(){},element:e,detach:function(){e.value=!1,e.removeEventListener("click",d),e.removeEventListener("keydown",n)},attach:function(){e.addEventListener("keydown",n),e.addEventListener("click",d)}}}return t._cellEditors[i]}_getEditorValue(e){const t=this,i=t._getEditorId(e);if(!t._cellEditors)return;const d=t._cellEditors[i];if(!d)return;const n=function(t){switch(e.column.dataType){case"float":case"int":case"number":t="int"===e.column.dataType?parseInt(t):parseFloat(t),isNaN(t)&&(t=0);break;case"bool":case"boolean":("true"===t||"1"===t)&&(t=!0),("false"===t||"0"===t)&&(t=!1);break;case"date":t=new Smart.Utilities.DateTime(t),t=t.toDate();break;case"dateTime":t=new Smart.Utilities.DateTime(t);}return t};let l=null;switch(e.editor.template){case"input":case"autoComplete":case"numberInput":case"deteTimePicker":case"checkBox":{try{l=n(d.getValue())}catch(t){l=e.value}if(e.editor.getValue){const t=e.editor.getValue(e,l);void 0!==t&&(l=t)}break}default:l=n(d.getValue());}let o=!0;return e.column.validator&&(o=e.column.validator.evaluate(l)),o?l:"invalid value"}_beginRowEdit(e,t){const d=this;if(e===d.editing.editRow)return!1;if(d.editing.editRow){const e=d.endEdit();if(!e)return!1}const n=e.cells;d.editing.editRow=e,d.editing.commandColumn.visible&&(d.editing.isEditing=!1,d.refresh(),d.editing.isEditing=!0),e.isEditing=!0;let l=!1;for(let o=0;o<n.length;o++){const e=n[o],i=d._beginCellEdit(e);t?e===t&&e.editor.instance.focus():i&&!l&&(l=!0,e.editor.instance.focus()),d.editing.commandColumn.visible&&e.column.commandColumn&&e.render()}return!0}_createOverlay(){const e=document.createElement("div");return e.onpointerdown=function(){return!1},e.onmousedown=function(){return!1},e.onclick=function(){},e.classList.add("smart-grid-dialog-overlay"),e}_createDialog(e){const t=this,i=document.createElement("div");e||(e=t.editing.dialog),i.setAttribute("animation","none"),i.classList.add("smart-window","smart-grid-dialog"),i.style.width="auto"===e.width?e.width:e.width+"px",i.style.height="auto"===e.height?e.height:e.height+"px",i.style.left="",i.style.top="",i.innerHTML=`<div class="smart-container">
                   <div class ="smart-content-container" smart-id="container">
                        <div id="headerSection" class="smart-header-section">
                            <div class="smart-header"></div>
                            <div class="smart-buttons-container">
                                <button class ="smart-button smart-element smart-close-button" aria-label="Close" smart-id="closeButton"></button>
                            </div>
                        </div>
                        <div class="smart-content"><div></div></div>
                        <div class ="smart-footer">
                            <div class ="smart-stack-layout right spacing">
                                <smart-button class ="smart-confirm-button item primary">Ok</smart-button>
                                <smart-button class ="smart-cancel-button item">Cancel</smart-button>
                            </div>
                        </div>
                    </div>
              </div>
            `,i.content=i.querySelector(".smart-content").firstChild,i.footer=i.querySelector(".smart-footer"),i.header=i.querySelector(".smart-header"),i.btnConfirm=i.querySelector(".smart-confirm-button"),i.btnCancel=i.querySelector(".smart-cancel-button"),i.btnClose=i.querySelector(".smart-close-button");const d=document.createElement("div");return d.classList.add("smart-grid-dialog-overlay"),d.onclick=function(){},i.overlay=d,i.remove=function(){i.parentNode&&i.parentNode.removeChild(i)},i.close=function(){i.classList.remove("open"),i.addEventListener("transitionend",i.remove),i.addEventListener("transitioncancel",i.remove),i.modal&&i.overlay.parentNode&&i.overlay.parentNode.removeChild(i.overlay),i.onClose&&i.onClose()},i.open=function(d,n){i.removeEventListener("transitionend",i.remove),i.removeEventListener("transitioncancel",i.remove),document.body.appendChild(i),d||(d=e.left),n||(n=e.top),requestAnimationFrame(function(){i.classList.add("open");const e=function(e,d){const n=t.offset(t);switch("center"===e&&"horizontal"===d&&(e="middle"),e){case"top":return n.top;case"bottom":return n.top+t.offsetHeight-i.offsetHeight;case"center":return n.top+t.offsetHeight/2-i.offsetHeight/2;case"left":return n.left;case"middle":return n.left+t.offsetWidth/2-i.offsetWidth/2;case"right":return n.left+t.offsetWidth-i.offsetWidth;}return"horizontal"===d?parseInt(e)+n.left:"vertical"===d?parseInt(e)+n.top:"number"==typeof e?e:parseInt(e)};i.style.left=e(d,"horizontal")+"px",i.style.top=e(n,"vertical")+"px"}),i.modal&&t.appendChild(i.overlay),i.onOpen&&i.onOpen()},i}_openAddRowDialog(e,t){const d=this;if(!d.editing.addDialog.enabled)return!1;const n=d._dialogAddRow||d._createDialog(),i="{{message}}"===d.editing.dialog.header?d.localize("dialogAddHeader"):d.editing.dialog.header,l=n.content;n.header.innerHTML=i,e.grid=d,void 0===e.index&&(e.index=d.rows.length,d._rowsAdded&&(e.index+=d._rowsAdded.length));const o=e.cells;let a=null,r=0;if(d._cellEditors||(d._cellEditors=[]),!d._dialogAddRow){n.modal=!0,n.btnConfirm.innerHTML=d.localize("dialogAddButtonConfirm"),n.btnCancel.innerHTML=d.localize("dialogAddButtonCancel"),n.onOpen=function(){d.editing.dialog.visible=!0},n.onClose=function(){d.editing.dialog.visible=!1},n.btnCancel.onclick=function(){n.close()},n.btnClose.onclick=function(){n.close()},n.btnConfirm.onclick=function(){const e={};for(let t=0;t<o.length;t++){const i=o[t],n=d._getEditorValue(i),l=d._getEditorId(i),a=d._cellEditors[l];e[i.column.dataField]=n,a.detach()}const i=d._rowsAdded?d._rowsAdded.length:0,l=new Smart.Grid.Row({index:d.rows.length+i,grid:d,data:e});n.close(),t(l,0===n.index)},n.onkeydown=function(e){const t=e.key;"Enter"===t?n.btnConfirm.onclick():"Escape"===t&&n.close()},l.classList.add("smart-grid-layout");for(let e=0;e<d.columns.length;e++){const t=d.columns[e];if(!t.allowEdit)continue;0==r%2&&(a=document.createElement("div"),a.classList.add("row"),l.appendChild(a));const i=document.createElement("div");i.classList.add("col-sm-6");const n=document.createElement("div");n.classList.add("column");const o=document.createElement("label");o.innerHTML=d.columns[e].label;const s=document.createElement("div");s.classList.add("smart-grid-dialog-editor"),s.setAttribute("editor",t.dataField),s.setAttribute("template",t.editor.template),i.appendChild(n),a.appendChild(i),n.appendChild(o),n.appendChild(s),r++}}n.open(),n.index=e.index;for(let l=0;l<o.length;l++){const e=o[l],t=e.column,i=t.dataField,a=n.querySelector("[editor="+i+"]");a.innerHTML="";let r="";void 0===e.value?(("int64"===t.dataType||"number"===t.dataType||"int"===t.dataType||"float"===t.dataType)&&(r=0),"date"===t.dataType&&(r=new Date),("bool"===t.dataType||"boolean"===t.dataType)&&(r=!1)):r=e.value;let s=null;switch(e.editor.template){default:case"custom":{s=d._getCustomCellEditor(e);break}case"checkBox":{s=d._getCheckBoxCellEditor(e);break}case"autoComplete":{s=d._getAutoCompleteCellEditor(e);break}case"dateTimePicker":s=d._getDateTimePickerCellEditor(e);break;case"textArea":case"textarea":{s=d._getTextAreaCellEditor(e);break}case"numberInput":case"input":{s="numberInput"===e.editor.template?d._getNumberInputCellEditor(e):d._getInputCellEditor(e);break}}s.attach(),e.editor.instance=s,s.setValue(r),0==l&&s.focus(),e.editor.isInitialized||(e.editor.isInitialized=!0,e.editor.onInit&&e.editor.onInit(e.row.index,e.column.dataField,e.editor.instance.element)),e.editor.onRender&&e.editor.onRender(e.row.index,e.column.dataField,e.editor.instance.element),a.appendChild(s.element)}d._dialogAddRow=n}_openEditDialog(e,t){const d=this;if(!d.editing.dialog.enabled)return!1;const i=d._dialogEdit||d._createDialog(),n="{{message}}"===d.editing.dialog.header?d.localize("dialogEditHeader",{value:d.editing.editRow?e.row.visibleIndex+1:e.column.label}):d.editing.dialog.header,l=i.content;i.header.innerHTML=n;let o=null,a=0;if(!d._dialogEdit)if(i.modal=!0,i.btnConfirm.innerHTML=d.localize("dialogEditButtonConfirm"),i.btnCancel.innerHTML=d.localize("dialogEditButtonCancel"),i.onOpen=function(){d.editing.dialog.visible=!0},i.onClose=function(){d.editing.dialog.visible=!1},i.btnCancel.onclick=function(){d.cancelEdit()},i.btnClose.onclick=function(){d.cancelEdit()},i.btnConfirm.onclick=function(){d.endEdit()},i.onkeydown=function(e){const t=e.key,i=d.editing.commandKeys;for(let n in i){const e=i[n];if(t===e.key){d._applyCommand(e.command);break}}},d.editing.editRow){l.classList.add("smart-grid-layout");for(let e=0;e<d.columns.length;e++){const t=d.columns[e];if(!t.allowEdit)continue;0==a%2&&(o=document.createElement("div"),o.classList.add("row"),l.appendChild(o));const i=document.createElement("div");i.classList.add("col-sm-6");const n=document.createElement("div");n.classList.add("column");const r=document.createElement("label");r.innerHTML=d.columns[e].label;const s=document.createElement("div");s.classList.add("smart-grid-dialog-editor"),s.setAttribute("editor",t.dataField),s.setAttribute("template",t.editor.template),i.appendChild(n),o.appendChild(i),n.appendChild(r),n.appendChild(s),a++}}else{const t=e.column,i=document.createElement("div");i.classList.add("smart-grid-dialog-editor"),i.setAttribute("editor",""),i.setAttribute("template",t.editor.template),l.appendChild(i)}if(i.open(),d.editing.editRow){const d=i.querySelector("[editor="+e.column.dataField+"]");d.innerHTML="",d.appendChild(t.element)}else{const d=e.column,n=i.querySelector("[editor]");n.innerHTML="",n.setAttribute("template",d.editor.template),n.appendChild(t.element)}d._dialogEdit=i}_openDeleteRowDialog(e,t){const i=this;if(!i.editing.deleteDialog.enabled)return!1;const d=i._dialogDelete||i._createDialog(),n="{{message}}"===i.editing.dialog.header?i.localize("dialogDeleteHeader",{value:e.visibleIndex+1}):i.editing.dialog.header;d.header.innerHTML=n,d.content.innerHTML=i.localize("dialogDeleteContent"),d.row=e,i._dialogDelete||(d.modal=!0,d.btnConfirm.innerHTML=i.localize("dialogDeleteButtonConfirm"),d.btnCancel.innerHTML=i.localize("dialogDeleteButtonCancel"),d.onOpen=function(){i.editing.dialog.visible=!0},d.onClose=function(){i.editing.dialog.visible=!1},d.btnCancel.onclick=function(){d.close()},d.btnClose.onclick=function(){d.close()},d.btnConfirm.onclick=function(){t(d.row),d.close()},d.onkeydown=function(e){"Escape"===e.key&&d.close()},i._dialogDelete=d),d.open(),setTimeout(function(){d.btnConfirm.focus()},100)}_beginCellEdit(e,t){const i=this;if(e.isEditing)return!1;let d=!1;if(e.column.autoGenerated&&e.column.rowHeaderColumn&&i.editing.allowRowHeaderEdit&&new Date-i._clickTime<i.behavior.doubleClickTimingDelay&&i._clickedCell===e.element&&(d=!0),(!e.column.allowEdit||e.column.autoGenerated||e.readonly)&&!d)return!1;if(i.editing.editCell&&!i.editing.editRow){const e=i._endCellEdit();if(!1===e)return!1}i._cellEditors||(i._cellEditors=[]),i.editing.editRow||(i.editing.editCell=e),i.editing.commandColumn.visible&&!i.editing.editRow&&(i.editing.isEditing=!1,i.refresh(),i.editing.isEditing=!0),e.row.element.setAttribute("edit",""),i.editing.isEditing=!0,i._selection.selectionRect&&i._selection.selectionRect.classList.add("smart-visibility-hidden");const n=t=>{const d=t.element;i.editing.dialog.enabled?i._openEditDialog(e,t):(!e.element&&e.createElement(),e.element.setAttribute("editor","string"==typeof e.editor.template?e.editor.template:"template"),e.element.content.innerHTML="",e.element.content.appendChild(d),i.editing.editRow&&e.element.setAttribute("row-editor","")),t.attach(),e.editor.row=e.row,e.editor.column=e.column,e.editor.cell=e,e.editor.instance=t,e.isEditing=!0},l=i._cellsUpdatedValues?i._cellsUpdatedValues[e.row.id+"_"+e.column.dataField]:void 0;let o=void 0===l?e.value:l;if(void 0===o){o="";const t=e.column;"number"===t.dataType||"int"===t.dataType||"float"===t.dataType?o=0:"date"===t.dataType&&(o=new Date,o.setTime(0,0,0))}switch(e.editor||(e.editor="input"),"string"==typeof e.editor&&(e.canNotify=!1,e.editor={template:e.editor,autoFocus:!0},e.canNotify=!0),e.editor.template){default:case"custom":{const t=i._getCustomCellEditor(e);n(t),t.setValue(o);break}case"checkBox":{const d=i._getCheckBoxCellEditor(e);n(d);const l=!0===o||1===o;if("checkBox"===e.template&&t){const e=(i.enableShadowDOM?i.shadowRoot:i.getRootNode()).elementsFromPoint(t.clientX,t.clientY);e[0].classList.contains("smart-input")?d.setValue(!l):d.setValue(l)}else d.setValue(l);break}case"autoComplete":{const t=i._getAutoCompleteCellEditor(e);n(t),t.setValue(o),e.editor.autoOpen&&t.element.open();break}case"dateTimePicker":{const t=i._getDateTimePickerCellEditor(e);n(t),t.setValue(o),e.editor.autoOpen&&t.element.open();break}case"textArea":{const t=i._getTextAreaCellEditor(e);n(t),t.setValue(o);break}case"numberInput":case"input":{const t="numberInput"===e.editor.template?i._getNumberInputCellEditor(e):i._getInputCellEditor(e);n(t),t.setValue(o);break}}return e.editor.isInitialized||(e.editor.isInitialized=!0,e.editor.onInit&&e.editor.onInit(e.row.index,e.column.dataField,e.editor.instance.element)),e.editor.onRender&&e.editor.onRender(e.row.index,e.column.dataField,e.editor.instance.element),i.editing.editCell&&e.editor.instance.focus(),!0}_onColumnDoubleClick(e){const t=this;t._beginColumnEdit(e)}_beginColumnEdit(e){const t=this;if(t.editing.enabled&&t.editing.allowColumnHeaderEdit&&e.allowHeaderEdit){t.editing.isEditing&&t.endEdit(),t.editing.editColumn=e,t._cellEditors||(t._cellEditors=[]);const i=t._getInputCellEditor({column:e,row:t.rows[0],editor:{template:"input"}});i.element.value=e.label,i.focus(),e.headerEditor=i,e.element.setAttribute("edit",""),e.element.label.appendChild(i.element),i.attach(),t.editing.isEditing=!0,t.$.fireEvent("beginEdit",{row:null,column:e,cell:null})}}_endColumnEdit(e){const t=this;if(!1===t.editing.isEditing||t.editing.isEditing&&null===t.editing.editColumn)return!1;const i=t.editing.editColumn;return i.canNotify=!1,i.headerEditor.detach(),i.headerEditor.element.parentNode.removeChild(i.headerEditor.element),!0!==e&&(i.label=i.headerEditor.getValue()),i.headerEditor=null,t.editing.isEditing=!1,i.element.removeAttribute("edit"),i.element.scrollLeft=0,t.editing.editColumn=null,i.canNotify=!0,i.refresh(),t._recycle(),!0}_cancelColumnEdit(){const e=this;e._endColumnEdit(!0)}_onCellClick(e,t){const i=this;if(e.row.addNewRow)return void("far"===e.row.freeze?i._insertNewRowAfter():i._insertNewRowBefore());if(i.editing.enabled){if(i.editing.editColumn)return void i.endEdit();if(i.editing.commandColumn.visible)if(e.column.commandColumn){const d=(i.enableShadowDOM?i.shadowRoot:i.getRootNode()).elementsFromPoint(t.pageX,t.pageY);let n=null;for(let e=0;e<d.length;e++)if(d[e].classList.contains("smart-grid-command-item")){n=d[e];break}if(n||(n=e.element.querySelector(".smart-grid-command-item")),n&&!n.classList.contains("smart-hidden")){const d=n.getAttribute("command");return void i._applyCommand(d,[e.row,t])}}else if(i.editing.commandColumn.inline){const e=(i.enableShadowDOM?i.shadowRoot:i.getRootNode()).elementsFromPoint(t.pageX,t.pageY);for(let t=0;t<e.length;t++)if(e[t].classList.contains("smart-grid-command-item"))return}if("none"===i.editing.action&&i.editing.isEditing){let t=!1;i.editing.editCell&&i.editing.editCell.row!==e.row&&(t=!0),i.editing.editRow&&i.editing.editRow!==e.row&&(t=!0),i.editing.editColumn&&(t=!0),t&&i.endEdit()}if(e.column.autoGenerated)return void(i.editing.allowRowHeaderEdit&&e.column.rowHeaderColumn&&(i.editing.isEditing&&i.endEdit(),i._beginCellEdit(e,t)));if("click"===i.editing.action&&(!i.selection.enabled||e.selected||"extended"!==i.selection.mode))if("cell"===i.editing.mode){const d=e.parent();i.ensureVisible(e.row.id,e.column.dataField),setTimeout(function(){d?i._beginCellEdit(d,t):i._beginCellEdit(e,t)},25)}else"row"===i.editing.mode&&i._beginRowEdit(e.row,e,t)}}_onCellDoubleClick(e,t){const i=this;!i.editing.enabled||"doubleClick"!==i.editing.action||i.editing.isEditing||e.column.autoGenerated||("cell"===i.editing.mode?i._beginCellEdit(e,t):"row"===i.editing.mode&&i._beginRowEdit(e.row,e,t))}_onRowClick(){}_onRowDoubleClick(){}beginEdit(e,t){const i=this,d=i.rowById[e];d&&i._beginEdit(d,t)}cancelEdit(){const e=this;if(e.editing.editRow){const t=e.editing.editRow.cells;for(let e=0;e<t.length;e++){const i=t[e],d=i.element;0==e&&i.row.element.removeAttribute("edit"),d&&(d.removeAttribute("editor"),d.removeAttribute("error"),d.content.innerHTML=""),i.isEditing=!1}e.editing.editRow=null}else e.editing.editCell?(e.editing.editCell.row.element.removeAttribute("edit"),e.editing.editCell.element.removeAttribute("editor"),e.editing.editCell.element.removeAttribute("error"),e.editing.editCell.element.content.innerHTML="",e.editing.editCell.isEditing=!1,e.editing.editCell=null):e.editing.editColumn&&e._cancelColumnEdit();e.editing.dialog.visible&&e.editing.dialog.enabled&&e._dialogEdit.close(),e.editing.isEditing=!1,e._recycle(!1),e.editing.commandColumn.visible&&e.refresh(),e.focus()}deleteRow(e,t){const i=this,d=i.rowById[e];if(!d)return!1;const n=function(e){if(!0===i.editing.batch||i.editing.batch&&0<=i.editing.batch.indexOf("delete"))i._batchDeleteRow(e);else{const t=i.rows.indexOf(e);i.rows.splice(t,1)}t&&t(e)};return i.editing.deleteDialog.enabled?i._openDeleteRowDialog(d,n):n(d),!0}addUnboundRow(e,t){const i=this;void 0===e&&(e=1),void 0===t&&(t="far"),i._nearRowsAdded||(i._nearRowsAdded=[],i._farRowsAdded=[]),i._unboundRows||(i._unboundRows=[]),i.beginUpdate();for(let d=0;d<e;d++){const e=Smart.Utilities.Core.createGUID().replace(/-/ig,""),d=new Smart.Grid.Row({index:-1,unbound:!0,id:e,grid:i});i.rowById[d.id]=d,"far"===t?i._farRowsAdded.push(d):i._nearRowsAdded.push(d),i._unboundRows.push(d)}i.endUpdate()}addNewRow(e){const t=this;"near"===e?t._insertNewRowBefore():t._insertNewRowAfter()}endEdit(){const e=this;let t=!1,i=null;e.editing.dialog.enabled&&e.editing.dialog.visible&&e._dialogEdit&&e._dialogEdit.close();let d=null,n=null,l=null;return e.editing.editRow?(n=e.editing.editRow,i=e.editing.editRow.id,t=e._endRowEdit()):e.editing.editCell?(n=e.editing.editCell.row,l=e.editing.editCell.column,d=e.editing.editCell,i=e.editing.editCell.row.id,t=e._endCellEdit()):e.editing.editColumn&&(i=null,l=e.editing.editColumn,t=e._endColumnEdit()),e._saveUnboundRows(i),e._selection.selectionRect&&e._selection.selectionRect.classList.remove("smart-visibility-hidden"),e.$.scrollView.scrollTop=0,e.$.fireEvent("endEdit",{row:n,column:l,cell:d}),t}getBatchEditChanges(){const e=this,t=[],d=[],n=[];for(let i in e._cellsUpdatedValues){const d=e._cellsUpdatedValues[i],n=i.substring(0,i.indexOf("_")),l=i.substring(i.indexOf("_")+1),o=e.rowById[n],a=o.getCell(l);t.push({id:n,dataField:l,oldValue:a.value,newValue:d})}if(e._rowsDeleted&&0<e._rowsDeleted.length)for(let t=0;t<e._rowsDeleted.length;t++){const i=e._rowsDeleted[t];d.push({id:i.id,data:i})}if(e._rowsAdded&&0<e._rowsAdded.length)for(let t=0;t<e._rowsAdded.length;t++){const i=e._rowsAdded[t];n.push({id:i.id,data:i})}return{updated:t,deleted:d,added:n}}saveBatchEdit(){const e=this;e._saveBatchEdit()}revertBatchEdit(){const e=this;e._clearBatchEdit(!0)}});